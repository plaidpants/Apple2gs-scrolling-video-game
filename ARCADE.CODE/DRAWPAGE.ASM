         keep  /apw.code/arcade.code/drawpage.e         copy  /apw.code/arcade.code/globals.asm         mcopy /apw.code/arcade.code/drawpage.macros         copy  2/ainclude/e16.quickdrawInitColors start         stz   ColorTableNumber         rts         endProcessColors start;cycle to next color table         using DrawPage         lda   ColorTableNumber         clc         adc   #$0020         and   #$01FF         sta   ColorTableNumber         clc         adc   #$7E00         tax         ldy   #$E19E00         lda   #$0020-1         phb                            save data bank         mvn   DrawPage,$E19E00         copy to color table 0         plb                            restore data bank         rts         endBlackScreen start         ldy   #0loop1    ldx   #0loop2    lda   >$E19E00,x         lsr   a         and   #$0777         sta   >$E19E00,x         inx         inx         cpx   #$20         bne   loop2         iny         cpy   #4         bne   loop1         rts         endInitDrawPage start;load startup screen into draw page         using DrawPage         using GSOSParam         lda   #StartupScreenPath              init GSOSParam         sta   path         lda   #^StartupScreenPath         sta   path+2         lda   #$8000         sta   count         lda   #^$8000         sta   count+2         lda   #DrawPage         sta   buf         lda   #^DrawPage         sta   buf+2         jsr   ReadFile;copy startup screen from draw page to display screen         jsr   BlackScreen         ldx   #DrawPage         ldy   #$E12000         lda   #$8000-1         phb         mvn   DrawPage,$E12000         plb;load play screen to draw page         lda   #PlayScreenPath          init GSOSParam         sta   path         lda   #^PlayScreenPath         sta   path+2         lda   #$8000         sta   count         lda   #^$8000         sta   count+2         lda   #DrawPage         sta   buf         lda   #^DrawPage         sta   buf+2         jsr   ReadFile         rtsStartupScreenPath str 'startup.screen'PlayScreenPath str 'play.screen'         endUpdateTerrainScreen start;copy terrain screen from draw page to screen fast         using DrawPage         phb                            save direct page         lda   >$E0C035                 turn on shadowing         and   #%1111111111110111         sta   >$E0C035         pea   $0101                    move direct page to screen         plb         plb         ldx   #TerrainScreenXloop     anop         jsr   update         inx         inx         cpx   #TerrainScreenX+TerrainScreenWidth         bne   loop         lda   >$E0C035                   turn off shadowing         ora   #%0000000000001000         sta   >$E0C035         plb                            restore direct page         rtsupdate   anop;        lda   $2000,x;        sta   $2000,x;        lda   $20A0,x;        sta   $20A0,x;        lda   $2140,x;        sta   $2140,x;        lda   $21E0,x;        sta   $21E0,x         lda   $2280,x         sta   $2280,x         lda   $2320,x         sta   $2320,x         lda   $23C0,x         sta   $23C0,x         lda   $2460,x         sta   $2460,x         lda   $2500,x         sta   $2500,x         lda   $25A0,x         sta   $25A0,x         lda   $2640,x         sta   $2640,x         lda   $26E0,x         sta   $26E0,x         lda   $2780,x         sta   $2780,x         lda   $2820,x         sta   $2820,x         lda   $28C0,x         sta   $28C0,x         lda   $2960,x         sta   $2960,x         lda   $2A00,x         sta   $2A00,x         lda   $2AA0,x         sta   $2AA0,x         lda   $2B40,x         sta   $2B40,x         lda   $2BE0,x         sta   $2BE0,x         lda   $2C80,x         sta   $2C80,x         lda   $2D20,x         sta   $2D20,x         lda   $2DC0,x         sta   $2DC0,x         lda   $2E60,x         sta   $2E60,x         lda   $2F00,x         sta   $2F00,x         lda   $2FA0,x         sta   $2FA0,x         lda   $3040,x         sta   $3040,x         lda   $30E0,x         sta   $30E0,x         lda   $3180,x         sta   $3180,x         lda   $3220,x         sta   $3220,x         lda   $32C0,x         sta   $32C0,x         lda   $3360,x         sta   $3360,x         lda   $3400,x         sta   $3400,x         lda   $34A0,x         sta   $34A0,x         lda   $3540,x         sta   $3540,x         lda   $35E0,x         sta   $35E0,x         lda   $3680,x         sta   $3680,x         lda   $3720,x         sta   $3720,x         lda   $37C0,x         sta   $37C0,x         lda   $3860,x         sta   $3860,x         lda   $3900,x         sta   $3900,x         lda   $39A0,x         sta   $39A0,x         lda   $3A40,x         sta   $3A40,x         lda   $3AE0,x         sta   $3AE0,x         lda   $3B80,x         sta   $3B80,x         lda   $3C20,x         sta   $3C20,x         lda   $3CC0,x         sta   $3CC0,x         lda   $3D60,x         sta   $3D60,x         lda   $3E00,x         sta   $3E00,x         lda   $3EA0,x         sta   $3EA0,x         lda   $3F40,x         sta   $3F40,x         lda   $3FE0,x         sta   $3FE0,x         lda   $4080,x         sta   $4080,x         lda   $4120,x         sta   $4120,x         lda   $41C0,x         sta   $41C0,x         lda   $4260,x         sta   $4260,x         lda   $4300,x         sta   $4300,x         lda   $43A0,x         sta   $43A0,x         lda   $4440,x         sta   $4440,x         lda   $44E0,x         sta   $44E0,x         lda   $4580,x         sta   $4580,x         lda   $4620,x         sta   $4620,x         lda   $46C0,x         sta   $46C0,x         lda   $4760,x         sta   $4760,x         lda   $4800,x         sta   $4800,x         lda   $48A0,x         sta   $48A0,x         lda   $4940,x         sta   $4940,x         lda   $49E0,x         sta   $49E0,x         lda   $4A80,x         sta   $4A80,x         lda   $4B20,x         sta   $4B20,x         lda   $4BC0,x         sta   $4BC0,x         lda   $4C60,x         sta   $4C60,x         lda   $4D00,x         sta   $4D00,x         lda   $4DA0,x         sta   $4DA0,x         lda   $4E40,x         sta   $4E40,x         lda   $4EE0,x         sta   $4EE0,x         lda   $4F80,x         sta   $4F80,x         lda   $5020,x         sta   $5020,x         lda   $50C0,x         sta   $50C0,x         lda   $5160,x         sta   $5160,x         lda   $5200,x         sta   $5200,x         lda   $52A0,x         sta   $52A0,x         lda   $5340,x         sta   $5340,x         lda   $53E0,x         sta   $53E0,x         lda   $5480,x         sta   $5480,x         lda   $5520,x         sta   $5520,x         lda   $55C0,x         sta   $55C0,x         lda   $5660,x         sta   $5660,x         lda   $5700,x         sta   $5700,x         lda   $57A0,x         sta   $57A0,x         lda   $5840,x         sta   $5840,x         lda   $58E0,x         sta   $58E0,x         lda   $5980,x         sta   $5980,x         lda   $5A20,x         sta   $5A20,x         lda   $5AC0,x         sta   $5AC0,x         lda   $5B60,x         sta   $5B60,x         lda   $5C00,x         sta   $5C00,x         lda   $5CA0,x         sta   $5CA0,x         lda   $5D40,x         sta   $5D40,x         lda   $5DE0,x         sta   $5DE0,x         lda   $5E80,x         sta   $5E80,x         lda   $5F20,x         sta   $5F20,x         lda   $5FC0,x         sta   $5FC0,x         lda   $6060,x         sta   $6060,x         lda   $6100,x         sta   $6100,x         lda   $61A0,x         sta   $61A0,x         lda   $6240,x         sta   $6240,x         lda   $62E0,x         sta   $62E0,x         lda   $6380,x         sta   $6380,x         lda   $6420,x         sta   $6420,x         lda   $64C0,x         sta   $64C0,x         lda   $6560,x         sta   $6560,x         lda   $6600,x         sta   $6600,x         lda   $66A0,x         sta   $66A0,x         lda   $6740,x         sta   $6740,x         lda   $67E0,x         sta   $67E0,x         lda   $6880,x         sta   $6880,x         lda   $6920,x         sta   $6920,x         lda   $69C0,x         sta   $69C0,x         lda   $6A60,x         sta   $6A60,x         lda   $6B00,x         sta   $6B00,x         lda   $6BA0,x         sta   $6BA0,x         lda   $6C40,x         sta   $6C40,x         lda   $6CE0,x         sta   $6CE0,x         lda   $6D80,x         sta   $6D80,x         lda   $6E20,x         sta   $6E20,x         lda   $6EC0,x         sta   $6EC0,x         lda   $6F60,x         sta   $6F60,x         lda   $7000,x         sta   $7000,x         lda   $70A0,x         sta   $70A0,x         lda   $7140,x         sta   $7140,x         lda   $71E0,x         sta   $71E0,x         lda   $7280,x         sta   $7280,x         lda   $7320,x         sta   $7320,x         lda   $73C0,x         sta   $73C0,x         lda   $7460,x         sta   $7460,x         lda   $7500,x         sta   $7500,x         lda   $75A0,x         sta   $75A0,x         lda   $7640,x         sta   $7640,x         lda   $76E0,x         sta   $76E0,x         lda   $7780,x         sta   $7780,x         lda   $7820,x         sta   $7820,x         lda   $78C0,x         sta   $78C0,x         lda   $7960,x         sta   $7960,x         lda   $7A00,x         sta   $7A00,x         lda   $7AA0,x         sta   $7AA0,x         lda   $7B40,x         sta   $7B40,x         lda   $7BE0,x         sta   $7BE0,x         lda   $7C80,x         sta   $7C80,x         lda   $7D20,x         sta   $7D20,x         lda   $7DC0,x         sta   $7DC0,x         lda   $7E60,x         sta   $7E60,x         lda   $7F00,x         sta   $7F00,x         lda   $7FA0,x         sta   $7FA0,x         lda   $8040,x         sta   $8040,x         lda   $80E0,x         sta   $80E0,x         lda   $8180,x         sta   $8180,x         lda   $8220,x         sta   $8220,x         lda   $82C0,x         sta   $82C0,x         lda   $8360,x         sta   $8360,x         lda   $8400,x         sta   $8400,x         lda   $84A0,x         sta   $84A0,x         lda   $8540,x         sta   $8540,x         lda   $85E0,x         sta   $85E0,x         lda   $8680,x         sta   $8680,x         lda   $8720,x         sta   $8720,x         lda   $87C0,x         sta   $87C0,x         lda   $8860,x         sta   $8860,x         lda   $8900,x         sta   $8900,x         lda   $89A0,x         sta   $89A0,x         lda   $8A40,x         sta   $8A40,x         lda   $8AE0,x         sta   $8AE0,x         lda   $8B80,x         sta   $8B80,x         lda   $8C20,x         sta   $8C20,x         lda   $8CC0,x         sta   $8CC0,x         lda   $8D60,x         sta   $8D60,x         lda   $8E00,x         sta   $8E00,x         lda   $8EA0,x         sta   $8EA0,x         lda   $8F40,x         sta   $8F40,x         lda   $8FE0,x         sta   $8FE0,x         lda   $9080,x         sta   $9080,x         lda   $9120,x         sta   $9120,x         lda   $91C0,x         sta   $91C0,x         lda   $9260,x         sta   $9260,x         lda   $9300,x         sta   $9300,x         lda   $93A0,x         sta   $93A0,x         lda   $9440,x         sta   $9440,x         lda   $94E0,x         sta   $94E0,x         lda   $9580,x         sta   $9580,x         lda   $9620,x         sta   $9620,x         lda   $96C0,x         sta   $96C0,x         lda   $9760,x         sta   $9760,x         lda   $9800,x         sta   $9800,x         lda   $98A0,x         sta   $98A0,x         lda   $9940,x         sta   $9940,x         lda   $99E0,x         sta   $99E0,x;        lda   $9A80,x;        sta   $9A80,x;        lda   $9B20,x;        sta   $9B20,x;        lda   $9BC0,x;        sta   $9BC0,x;        lda   $9C60,x;        sta   $9C60,x         rtsupdateold anop;        lda   >DrawPage+$0000,x;        sta   $2000,x;        lda   >DrawPage+$00A0,x;        sta   $20A0,x;        lda   >DrawPage+$0140,x;        sta   $2140,x;        lda   >DrawPage+$01E0,x;        sta   $21E0,x         lda   >DrawPage+$0280,x         sta   $2280,x         lda   >DrawPage+$0320,x         sta   $2320,x         lda   >DrawPage+$03C0,x         sta   $23C0,x         lda   >DrawPage+$0460,x         sta   $2460,x         lda   >DrawPage+$0500,x         sta   $2500,x         lda   >DrawPage+$05A0,x         sta   $25A0,x         lda   >DrawPage+$0640,x         sta   $2640,x         lda   >DrawPage+$06E0,x         sta   $26E0,x         lda   >DrawPage+$0780,x         sta   $2780,x         lda   >DrawPage+$0820,x         sta   $2820,x         lda   >DrawPage+$08C0,x         sta   $28C0,x         lda   >DrawPage+$0960,x         sta   $2960,x         lda   >DrawPage+$0A00,x         sta   $2A00,x         lda   >DrawPage+$0AA0,x         sta   $2AA0,x         lda   >DrawPage+$0B40,x         sta   $2B40,x         lda   >DrawPage+$0BE0,x         sta   $2BE0,x         lda   >DrawPage+$0C80,x         sta   $2C80,x         lda   >DrawPage+$0D20,x         sta   $2D20,x         lda   >DrawPage+$0DC0,x         sta   $2DC0,x         lda   >DrawPage+$0E60,x         sta   $2E60,x         lda   >DrawPage+$0F00,x         sta   $2F00,x         lda   >DrawPage+$0FA0,x         sta   $2FA0,x         lda   >DrawPage+$1040,x         sta   $3040,x         lda   >DrawPage+$10E0,x         sta   $30E0,x         lda   >DrawPage+$1180,x         sta   $3180,x         lda   >DrawPage+$1220,x         sta   $3220,x         lda   >DrawPage+$12C0,x         sta   $32C0,x         lda   >DrawPage+$1360,x         sta   $3360,x         lda   >DrawPage+$1400,x         sta   $3400,x         lda   >DrawPage+$14A0,x         sta   $34A0,x         lda   >DrawPage+$1540,x         sta   $3540,x         lda   >DrawPage+$15E0,x         sta   $35E0,x         lda   >DrawPage+$1680,x         sta   $3680,x         lda   >DrawPage+$1720,x         sta   $3720,x         lda   >DrawPage+$17C0,x         sta   $37C0,x         lda   >DrawPage+$1860,x         sta   $3860,x         lda   >DrawPage+$1900,x         sta   $3900,x         lda   >DrawPage+$19A0,x         sta   $39A0,x         lda   >DrawPage+$1A40,x         sta   $3A40,x         lda   >DrawPage+$1AE0,x         sta   $3AE0,x         lda   >DrawPage+$1B80,x         sta   $3B80,x         lda   >DrawPage+$1C20,x         sta   $3C20,x         lda   >DrawPage+$1CC0,x         sta   $3CC0,x         lda   >DrawPage+$1D60,x         sta   $3D60,x         lda   >DrawPage+$1E00,x         sta   $3E00,x         lda   >DrawPage+$1EA0,x         sta   $3EA0,x         lda   >DrawPage+$1F40,x         sta   $3F40,x         lda   >DrawPage+$1FE0,x         sta   $3FE0,x         lda   >DrawPage+$2080,x         sta   $4080,x         lda   >DrawPage+$2120,x         sta   $4120,x         lda   >DrawPage+$21C0,x         sta   $41C0,x         lda   >DrawPage+$2260,x         sta   $4260,x         lda   >DrawPage+$2300,x         sta   $4300,x         lda   >DrawPage+$23A0,x         sta   $43A0,x         lda   >DrawPage+$2440,x         sta   $4440,x         lda   >DrawPage+$24E0,x         sta   $44E0,x         lda   >DrawPage+$2580,x         sta   $4580,x         lda   >DrawPage+$2620,x         sta   $4620,x         lda   >DrawPage+$26C0,x         sta   $46C0,x         lda   >DrawPage+$2760,x         sta   $4760,x         lda   >DrawPage+$2800,x         sta   $4800,x         lda   >DrawPage+$28A0,x         sta   $48A0,x         lda   >DrawPage+$2940,x         sta   $4940,x         lda   >DrawPage+$29E0,x         sta   $49E0,x         lda   >DrawPage+$2A80,x         sta   $4A80,x         lda   >DrawPage+$2B20,x         sta   $4B20,x         lda   >DrawPage+$2BC0,x         sta   $4BC0,x         lda   >DrawPage+$2C60,x         sta   $4C60,x         lda   >DrawPage+$2D00,x         sta   $4D00,x         lda   >DrawPage+$2DA0,x         sta   $4DA0,x         lda   >DrawPage+$2E40,x         sta   $4E40,x         lda   >DrawPage+$2EE0,x         sta   $4EE0,x         lda   >DrawPage+$2F80,x         sta   $4F80,x         lda   >DrawPage+$3020,x         sta   $5020,x         lda   >DrawPage+$30C0,x         sta   $50C0,x         lda   >DrawPage+$3160,x         sta   $5160,x         lda   >DrawPage+$3200,x         sta   $5200,x         lda   >DrawPage+$32A0,x         sta   $52A0,x         lda   >DrawPage+$3340,x         sta   $5340,x         lda   >DrawPage+$33E0,x         sta   $53E0,x         lda   >DrawPage+$3480,x         sta   $5480,x         lda   >DrawPage+$3520,x         sta   $5520,x         lda   >DrawPage+$35C0,x         sta   $55C0,x         lda   >DrawPage+$3660,x         sta   $5660,x         lda   >DrawPage+$3700,x         sta   $5700,x         lda   >DrawPage+$37A0,x         sta   $57A0,x         lda   >DrawPage+$3840,x         sta   $5840,x         lda   >DrawPage+$38E0,x         sta   $58E0,x         lda   >DrawPage+$3980,x         sta   $5980,x         lda   >DrawPage+$3A20,x         sta   $5A20,x         lda   >DrawPage+$3AC0,x         sta   $5AC0,x         lda   >DrawPage+$3B60,x         sta   $5B60,x         lda   >DrawPage+$3C00,x         sta   $5C00,x         lda   >DrawPage+$3CA0,x         sta   $5CA0,x         lda   >DrawPage+$3D40,x         sta   $5D40,x         lda   >DrawPage+$3DE0,x         sta   $5DE0,x         lda   >DrawPage+$3E80,x         sta   $5E80,x         lda   >DrawPage+$3F20,x         sta   $5F20,x         lda   >DrawPage+$3FC0,x         sta   $5FC0,x         lda   >DrawPage+$4060,x         sta   $6060,x         lda   >DrawPage+$4100,x         sta   $6100,x         lda   >DrawPage+$41A0,x         sta   $61A0,x         lda   >DrawPage+$4240,x         sta   $6240,x         lda   >DrawPage+$42E0,x         sta   $62E0,x         lda   >DrawPage+$4380,x         sta   $6380,x         lda   >DrawPage+$4420,x         sta   $6420,x         lda   >DrawPage+$44C0,x         sta   $64C0,x         lda   >DrawPage+$4560,x         sta   $6560,x         lda   >DrawPage+$4600,x         sta   $6600,x         lda   >DrawPage+$46A0,x         sta   $66A0,x         lda   >DrawPage+$4740,x         sta   $6740,x         lda   >DrawPage+$47E0,x         sta   $67E0,x         lda   >DrawPage+$4880,x         sta   $6880,x         lda   >DrawPage+$4920,x         sta   $6920,x         lda   >DrawPage+$49C0,x         sta   $69C0,x         lda   >DrawPage+$4A60,x         sta   $6A60,x         lda   >DrawPage+$4B00,x         sta   $6B00,x         lda   >DrawPage+$4BA0,x         sta   $6BA0,x         lda   >DrawPage+$4C40,x         sta   $6C40,x         lda   >DrawPage+$4CE0,x         sta   $6CE0,x         lda   >DrawPage+$4D80,x         sta   $6D80,x         lda   >DrawPage+$4E20,x         sta   $6E20,x         lda   >DrawPage+$4EC0,x         sta   $6EC0,x         lda   >DrawPage+$4F60,x         sta   $6F60,x         lda   >DrawPage+$5000,x         sta   $7000,x         lda   >DrawPage+$50A0,x         sta   $70A0,x         lda   >DrawPage+$5140,x         sta   $7140,x         lda   >DrawPage+$51E0,x         sta   $71E0,x         lda   >DrawPage+$5280,x         sta   $7280,x         lda   >DrawPage+$5320,x         sta   $7320,x         lda   >DrawPage+$53C0,x         sta   $73C0,x         lda   >DrawPage+$5460,x         sta   $7460,x         lda   >DrawPage+$5500,x         sta   $7500,x         lda   >DrawPage+$55A0,x         sta   $75A0,x         lda   >DrawPage+$5640,x         sta   $7640,x         lda   >DrawPage+$56E0,x         sta   $76E0,x         lda   >DrawPage+$5780,x         sta   $7780,x         lda   >DrawPage+$5820,x         sta   $7820,x         lda   >DrawPage+$58C0,x         sta   $78C0,x         lda   >DrawPage+$5960,x         sta   $7960,x         lda   >DrawPage+$5A00,x         sta   $7A00,x         lda   >DrawPage+$5AA0,x         sta   $7AA0,x         lda   >DrawPage+$5B40,x         sta   $7B40,x         lda   >DrawPage+$5BE0,x         sta   $7BE0,x         lda   >DrawPage+$5C80,x         sta   $7C80,x         lda   >DrawPage+$5D20,x         sta   $7D20,x         lda   >DrawPage+$5DC0,x         sta   $7DC0,x         lda   >DrawPage+$5E60,x         sta   $7E60,x         lda   >DrawPage+$5F00,x         sta   $7F00,x         lda   >DrawPage+$5FA0,x         sta   $7FA0,x         lda   >DrawPage+$6040,x         sta   $8040,x         lda   >DrawPage+$60E0,x         sta   $80E0,x         lda   >DrawPage+$6180,x         sta   $8180,x         lda   >DrawPage+$6220,x         sta   $8220,x         lda   >DrawPage+$62C0,x         sta   $82C0,x         lda   >DrawPage+$6360,x         sta   $8360,x         lda   >DrawPage+$6400,x         sta   $8400,x         lda   >DrawPage+$64A0,x         sta   $84A0,x         lda   >DrawPage+$6540,x         sta   $8540,x         lda   >DrawPage+$65E0,x         sta   $85E0,x         lda   >DrawPage+$6680,x         sta   $8680,x         lda   >DrawPage+$6720,x         sta   $8720,x         lda   >DrawPage+$67C0,x         sta   $87C0,x         lda   >DrawPage+$6860,x         sta   $8860,x         lda   >DrawPage+$6900,x         sta   $8900,x         lda   >DrawPage+$69A0,x         sta   $89A0,x         lda   >DrawPage+$6A40,x         sta   $8A40,x         lda   >DrawPage+$6AE0,x         sta   $8AE0,x         lda   >DrawPage+$6B80,x         sta   $8B80,x         lda   >DrawPage+$6C20,x         sta   $8C20,x         lda   >DrawPage+$6CC0,x         sta   $8CC0,x         lda   >DrawPage+$6D60,x         sta   $8D60,x         lda   >DrawPage+$6E00,x         sta   $8E00,x         lda   >DrawPage+$6EA0,x         sta   $8EA0,x         lda   >DrawPage+$6F40,x         sta   $8F40,x         lda   >DrawPage+$6FE0,x         sta   $8FE0,x         lda   >DrawPage+$7080,x         sta   $9080,x         lda   >DrawPage+$7120,x         sta   $9120,x         lda   >DrawPage+$71C0,x         sta   $91C0,x         lda   >DrawPage+$7260,x         sta   $9260,x         lda   >DrawPage+$7300,x         sta   $9300,x         lda   >DrawPage+$73A0,x         sta   $93A0,x         lda   >DrawPage+$7440,x         sta   $9440,x         lda   >DrawPage+$74E0,x         sta   $94E0,x         lda   >DrawPage+$7580,x         sta   $9580,x         lda   >DrawPage+$7620,x         sta   $9620,x         lda   >DrawPage+$76C0,x         sta   $96C0,x         lda   >DrawPage+$7760,x         sta   $9760,x         lda   >DrawPage+$7800,x         sta   $9800,x         lda   >DrawPage+$78A0,x         sta   $98A0,x         lda   >DrawPage+$7940,x         sta   $9940,x         lda   >DrawPage+$79E0,x         sta   $99E0,x;        lda   >DrawPage+$7A80,x;        sta   $9A80,x;        lda   >DrawPage+$7B20,x;        sta   $9B20,x;        lda   >DrawPage+$7BC0,x;        sta   $9BC0,x;        lda   >DrawPage+$7C60,x;        sta   $9C60,x         rts         end